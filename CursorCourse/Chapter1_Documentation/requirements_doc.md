---
description: 要件定義の実施時に実行してください
globs: ["**/*"]
triggers: ["dev-requirements！！！"]
---

このファイルを参照したら「要件定義、はっじめるよー！！！！！！！」といってください。

# 要件定義ガイドライン

以下、要件定義時は絶対に守ってください。

- 指示される以外は、コア情報以外のスクリプトは不要です。提案しないでください。
- 勝手にスクリプトの変更を加えないでください。
- 「1. 要件定義 → 2. 詳細設計 - 方針作成 → 3. レビュー＆ブラッシュアップ → 4. ドキュメントアウトプット」の順で、作業が実施されるよう、ガイドしてください。
- 各工程で、提案内容に問題がないかをかならずユーザーに確認を入れてから次に進むようにしてください。

## 1. 要件定義
### 💡 Cursor Prompt: REQUIREMENT_GATHER_SINGLE
※コア情報以外のスクリプトは不要。表ではなく項目列挙で出力してください。

【入力データ】
- 要望ID：{{ REQ-1234 }}
- タイトル：{{ 例: 管理画面に検索フィルタを追加 }}
- 概要：{{ 取引ステータスで絞り込みたい }}

【タスク】
1. リポジトリを静的解析し、影響箇所を推定
   - 画面 / クラス・メソッド / DB テーブル
2. **要件ジャッジ** を Markdown で出力
   - やるべきか？（Yes / No / 要検討）
   - 優先度（高 / 中 / 低）
   - 影響範囲メモ
   - 判断理由 or 追加ヒアリング事項
3. 「要検討」の場合は **営業 / クライアント向けヒアリング依頼文** を生成

## 2. 詳細設計 - 方針作成
### 💡 Cursor Prompt: DETAIL_POLICY
※コア情報以外のスクリプトは省略。Markdown 見出し＋箇条書きで出力。

【タスク】
- 変更対象ファイル・関数
  - ファイルパス / 関数名 / 変更概要
- データ設計方針
  - 追加・変更・削除するテーブル/カラムと理由
- 画面設計方針（必要な場合のみ）
- API設計方針（必要な場合のみ）
- セキュリティ考慮事項
- パフォーマンス考慮事項
- 判断材料不足時はヒアリング依頼文を末尾に追加

## 3. レビュー＆ブラッシュアップ
### 💡 Cursor Prompt: REVIEW_PACKET
※コア情報以外のスクリプトは不要。Markdown で簡潔に。

以下を最新版ドラフトに追加し、Markdown で提示してください。

- 処理フロー (mermaid)
- 開発工数見積（タスク別時間 & 合計人日）
- 安全にリリースするための段階的な機能アップデート方針
- テスト戦略（単体/結合/E2E）
- リスク分析と対策
- 未確定事項（要確認ラベル付き）

## 4. ドキュメントアウトプット
### 💡 Cursor Prompt: FINAL_DOC
※冗長なコード断片は省き、Markdown で統合。長すぎる場合は .md ファイルで出力。

- プロジェクトルール抜粋
- 要件ジャッジ結果
- 変更対象ファイル・関数リスト
- データ設計方針
- 画面設計方針
- API設計方針
- 処理フロー (mermaid)
- 開発工数見積
- テスト戦略
- リスク分析と対策
- 未確定事項 & TODO

## 品質チェックリスト

### 機能要件
- [ ] ユーザーストーリーが明確に定義されている
- [ ] 受け入れ条件が具体的に記載されている
- [ ] エラーハンドリングが考慮されている

### 非機能要件
- [ ] パフォーマンス要件が定義されている
- [ ] セキュリティ要件が考慮されている
- [ ] 可用性・拡張性が検討されている

### 技術要件
- [ ] 既存システムとの整合性が確認されている
- [ ] データ移行の必要性が検討されている
- [ ] 運用・保守の観点が含まれている