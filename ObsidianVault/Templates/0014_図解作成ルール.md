# 0014\_図解作成ルール.md

## 📊 Template ID: 0014 - 図解作成ルール・ガイドライン

### 🎯 目的

draw.io を使用して、エンティティとロジックが明確な図解を作成するためのルールとガイドラインを提供する。

---

## 🔧 基本設定

### キャンバス設定

- **サイズ**: 1600x1200px（A4 横向き相当）
- **グリッド**: 10px 間隔で表示
- **背景色**: 白（#FFFFFF）
- **フォント**: Arial または システムフォント

### 色彩ルール

```
エンティティ: 緑系（#E8F5E9 背景、#2E7D32 枠線）
プロセス: 黄系（#FFFDE7 背景、#FBC02D 枠線）
判定: 紫系（#F3E5F5 背景、#7B1FA2 枠線）
データ: 青系（#E0F7FA 背景、#006064 枠線）
外部: ピンク系（#FCE4EC 背景、#AD1457 枠線）
```

---

## 📐 図形使用ルール

### 1. エンティティ（Entity）

**形状**: 角丸四角形
**用途**: システムの主要な構成要素、オブジェクト、モジュール
**例**: ユーザー、商品、注文、データベーステーブル

```
命名規則:
- 名詞形で記述
- 具体的で理解しやすい名前
- 略語は避ける
例: "User" ○、"U" ×
```

### 2. プロセス（Process）

**形状**: 楕円形
**用途**: 処理、アクション、機能
**例**: データ検証、計算処理、メール送信

```
命名規則:
- 動詞形で記述
- 処理内容が明確
- 「〜する」「〜を行う」
例: "データを検証する" ○、"検証" △
```

### 3. 判定（Decision）

**形状**: 菱形（ダイヤモンド）
**用途**: 条件分岐、判断ポイント
**例**: 認証チェック、データ存在確認、権限判定

```
命名規則:
- 疑問形で記述
- Yes/Noで答えられる
- 「〜か？」「〜である？」
例: "ユーザーは認証済みか？" ○、"認証" ×
```

### 4. データストア（Data Store）

**形状**: 円柱形
**用途**: データベース、ファイル、キャッシュ
**例**: ユーザー DB、設定ファイル、セッション

```
命名規則:
- データの種類を明記
- 「〜DB」「〜ファイル」「〜テーブル」
例: "ユーザーDB" ○、"DB" ×
```

### 5. 外部システム（External System）

**形状**: 人型アイコン
**用途**: 外部 API、他システム、ユーザー
**例**: 決済 API、メールサービス、管理者

```
命名規則:
- システム名を明記
- 「〜API」「〜サービス」
例: "決済API" ○、"外部" ×
```

---

## 🔗 関係線ルール

### 矢印の種類

```
実線矢印: 通常のデータフロー、処理フロー
破線矢印: 参照関係、依存関係
太線矢印: 主要なフロー、重要な関係
```

### ラベル付けルール

```
- 関係性を明確に記述
- 動詞形で表現
- 「〜を送信」「〜を取得」「〜を実行」
例: "データを送信" ○、"送信" △
```

### 色分けルール

```
正常フロー: 黒（#333333）
エラーフロー: 赤（#D32F2F）
成功フロー: 緑（#2E7D32）
```

---

## 📋 作成手順

### Step 1: 要件整理

```
1. 図解の目的を明確化
2. 対象システムの範囲を定義
3. 主要なエンティティをリストアップ
4. 処理フローを整理
```

### Step 2: レイアウト設計

```
1. 左から右へのフロー配置
2. 上から下への階層構造
3. 関連する要素をグループ化
4. 十分な余白を確保
```

### Step 3: 図形配置

```
1. エンティティを先に配置
2. プロセスを中央に配置
3. 判定を分岐点に配置
4. データストアを適切な位置に配置
```

### Step 4: 関係線追加

```
1. 主要なフローから描画
2. 矢印の方向を統一
3. 交差を最小限に抑制
4. ラベルを追加
```

### Step 5: 最終調整

```
1. 色の統一性確認
2. フォントサイズの統一
3. 配置バランスの調整
4. 凡例の追加
```

---

## ✅ チェックリスト

### 基本要素

- [ ] タイトルが明確
- [ ] 作成日・作成者が記載
- [ ] 凡例が含まれている
- [ ] 色分けが適切

### エンティティ

- [ ] 名詞形で命名
- [ ] 具体的で理解しやすい
- [ ] 緑系の色で統一

### プロセス

- [ ] 動詞形で命名
- [ ] 処理内容が明確
- [ ] 黄系の色で統一

### 判定

- [ ] 疑問形で命名
- [ ] Yes/No で答えられる
- [ ] 紫系の色で統一

### データストア

- [ ] データ種類が明確
- [ ] 青系の色で統一

### 関係線

- [ ] 矢印の方向が適切
- [ ] ラベルが分かりやすい
- [ ] 色分けが適切

---

## 🎨 デザインガイドライン

### フォント設定

```
タイトル: 16pt、太字
エンティティ: 14pt、太字
プロセス: 12pt、太字
判定: 12pt、太字
関係線ラベル: 10pt、標準
凡例: 10pt、標準
```

### 間隔設定

```
要素間の最小間隔: 20px
グループ間の間隔: 50px
キャンバス端からの余白: 50px
```

### 配置原則

```
1. 左から右への時系列フロー
2. 上から下への階層構造
3. 関連要素のグループ化
4. 対称性とバランスの維持
```

---

## 🔍 よくある間違いと対策

### 間違い例 1: 色の不統一

```
❌ 同じ種類の要素に異なる色を使用
✅ 要素の種類ごとに色を統一
```

### 間違い例 2: 矢印の方向不適切

```
❌ データの流れと逆向きの矢印
✅ データの流れに沿った矢印
```

### 間違い例 3: 命名が不明確

```
❌ "処理1"、"システムA"
✅ "ユーザー認証処理"、"決済API"
```

### 間違い例 4: 要素の配置が不適切

```
❌ 関連のない要素が近接
✅ 関連する要素をグループ化
```

---

## 📝 テンプレート使用例

### システム構成図の場合

```
1. ユーザー（エンティティ）
2. 認証処理（プロセス）
3. 認証済みか？（判定）
4. ユーザーDB（データストア）
5. 外部認証API（外部システム）
```

### 業務フロー図の場合

```
1. 申請者（エンティティ）
2. 申請処理（プロセス）
3. 承認が必要か？（判定）
4. 申請DB（データストア）
5. 承認者（エンティティ）
```

---

## 🚀 応用テクニック

### 複雑な図の分割

```
- 機能別にページを分割
- 詳細レベルを調整
- 参照関係を明示
```

### 動的要素の表現

```
- 状態遷移を矢印で表現
- タイムラインを左右で表現
- 条件分岐を色分けで表現
```

### 保守性の向上

```
- 命名規則の統一
- 更新履歴の記録
- バージョン管理の実施
```

---

## 📚 参考資料

### 推奨書籍

- UML 図の描き方
- システム設計の基礎
- 図解思考の技術

### 参考サイト

- draw.io 公式ドキュメント
- UML 記法ガイド
- フローチャート作成ガイド

---

## 🎨 統合図解作成ルール

### 図解作成時の出力形式

図解やダイアグラムを作成する場合は、以下の**両方の形式**で出力すること：

1. **Mermaid 形式**: `create_diagram`ツールを使用してチャット内で即座に表示
2. **Draw.io 形式**: `.drawio`ファイルとして保存し、後で編集可能な形式で提供

### Draw.io 出力時の要件

#### ファイル管理

- **保存場所**: `diagrams/`ディレクトリに保存
- **ファイル名**: 用途が分かりやすい名前（例：`system_architecture.drawio`）
- **文字エンコーディング**: UTF-8 で保存

#### 色分けルール適用

- **エンティティ**: 緑系（#E8F5E9 背景、#2E7D32 枠線）
- **プロセス**: 黄系（#FFFDE7 背景、#FBC02D 枠線）
- **判定**: 紫系（#F3E5F5 背景、#7B1FA2 枠線）
- **データ**: 青系（#E0F7FA 背景、#006064 枠線）
- **外部**: ピンク系（#FCE4EC 背景、#AD1457 枠線）

#### 編集可能性の確保

- **ID 付け**: 各要素に意味のある ID を付与
- **グループ化**: 関連する要素をグループ化
- **レイヤー管理**: 複雑な図では適切なレイヤー分け
- **コメント**: 必要に応じて説明コメントを追加

### 図解作成の統合手順

1. **要件分析**: 図解の目的と対象読者を明確化
2. **Mermaid 作成**: まず`create_diagram`で概要を表示
3. **Draw.io 作成**: 編集可能な`.drawio`ファイルを作成
4. **色分けルール適用**: 上記テンプレートに従った統一色彩
5. **レイアウト最適化**: 読みやすい配置とグループ化
6. **ID 体系整備**: 後の編集を考慮した命名規則
7. **最終確認**: 両形式の整合性確認

### Draw.io ファイル構造例

```xml
<mxfile host="app.diagrams.net" modified="YYYY-MM-DDTHH:MM:SS.000Z">
  <diagram name="図解名" id="unique-diagram-id">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- エンティティ例 -->
        <mxCell id="entity-1" value="エンティティ名"
                style="rounded=1;fillColor=#E8F5E9;strokeColor=#2E7D32;strokeWidth=2;"
                vertex="1" parent="1">
          <mxGeometry x="100" y="100" width="120" height="60" as="geometry" />
        </mxCell>

        <!-- プロセス例 -->
        <mxCell id="process-1" value="プロセス名"
                style="ellipse;fillColor=#FFFDE7;strokeColor=#FBC02D;strokeWidth=2;"
                vertex="1" parent="1">
          <mxGeometry x="300" y="100" width="120" height="60" as="geometry" />
        </mxCell>

        <!-- 接続線例 -->
        <mxCell id="connection-1" style="edgeStyle=orthogonalEdgeStyle;strokeColor=#333333;strokeWidth=2;"
                edge="1" parent="1" source="entity-1" target="process-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
```

### 品質チェックリスト

#### Mermaid 形式

- [ ] 適切な図形タイプの選択
- [ ] 色分けルールの適用
- [ ] 読みやすいレイアウト
- [ ] 適切なラベル付け

#### Draw.io 形式

- [ ] ファイル名が分かりやすい
- [ ] 適切なディレクトリに保存
- [ ] 統一された色分け
- [ ] 編集しやすい ID 付け
- [ ] 適切なグループ化
- [ ] 凡例の追加

#### 両形式共通

- [ ] 内容の整合性確認
- [ ] 対象読者に適した表現
- [ ] 将来の保守性考慮

---

## 💡 使用上の注意

1. **目的に応じた図の選択**: システム構成図、フロー図、ER 図など
2. **対象読者の考慮**: 技術者向け、非技術者向けで表現を調整
3. **更新の容易性**: 将来の変更を考慮した設計
4. **標準化の重要性**: チーム内での統一ルールの確立

---

## 🎯 学習目標

### 初級レベル

- [ ] 基本図形の使い分けができる
- [ ] 適切な色分けができる
- [ ] 簡単なフロー図が作成できる

### 中級レベル

- [ ] 複雑なシステム図が作成できる
- [ ] 効果的なレイアウトが設計できる
- [ ] 保守しやすい図が作成できる

### 上級レベル

- [ ] 標準化されたルールを作成できる
- [ ] チーム向けのガイドラインが作成できる
- [ ] 複数の図を連携させた設計ができる

---

最終更新: 2025-07-15 23:46:45 JST
